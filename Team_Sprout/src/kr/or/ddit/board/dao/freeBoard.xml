<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="freeBoard">

	<select id="getAllFreeBoard" parameterClass="kr.or.ddit.board.vo.FreeBoardVO" resultClass="kr.or.ddit.board.vo.FreeBoardVO">
		SELECT A.FREE_NM       freeNm
			 , A.FREE_TITLE    freeTitle
			 , A.FREE_CONTENT  freeContent
			 , A.FREE_DATE     freeDate
			 , (
			 	SELECT USER_NICKNAME 
			 	FROM   TB_USER
			 	WHERE  USER_ID = A.USER_ID
			 	)            freeWriter
			 , ATCH_FILE_ID atchFileId
		FROM   FREE_BOARD A
		ORDER  BY 1 DESC		
	</select>
	
	<select id="getFreeBoard" parameterClass="String" resultClass="kr.or.ddit.board.vo.FreeBoardVO">
		SELECT A.FREE_NM      freeNm
			 , A.FREE_TITLE   freeTitle
			 , A.FREE_CONTENT freeContent
			 , A.FREE_DATE    freeDate
			 , (
			 	SELECT USER_NICKNAME 
			 	FROM   TB_USER
			 	WHERE  USER_ID = A.USER_ID
			 	)			  freeWriter 
			 , A.ATCH_FILE_ID atchFileId
		FROM   FREE_BOARD A			
		WHERE  1=1
		AND    A.FREE_NM = #freeNm#
	</select>
	
	<insert id="insertFreeBoard" parameterClass="kr.or.ddit.board.vo.FreeBoardVO">
		INSERT INTO FREE_BOARD(
			 FREE_NM
			,FREE_TITLE
			,FREE_CONTENT
			,FREE_DATE
			,USER_ID
			,ATCH_FILE_ID 
		)
		VALUES (
			FREE_BOARD_SEQ.NEXTVAL
		  , #freeTitle#
		  , #freeContent#
		  , SYSDATE
		  , #freeWriter#
		  , #atchFileId#
		)
	</insert>
	
	<update id="updateFreeBoard" parameterClass="kr.or.ddit.board.vo.FreeBoardVO">
		UPDATE  FREE_BOARD
		SET	    FREE_TITLE   = #freeTitle#
			   ,FREE_CONTENT = #freeContent#
			   ,FREE_DATE    = SYSDATE
			   ,ATCH_FILE_ID = #atchFileId#            
		WHERE   FREE_NM = #freeNm#
	</update>
	
	<delete id="deleteFreeBoard" parameterClass="kr.or.ddit.board.vo.FreeBoardVO">
		DELETE FROM FREE_BOARD
		WHERE  FREE_NM = #freeNm#
	</delete>
	
	<select id="searchFreeBoard" parameterClass="String" resultClass="kr.or.ddit.board.vo.FreeBoardVO">
		SELECT A.FREE_NM       freeNm
			 , A.FREE_TITLE    freeTitle
			 , A.FREE_CONTENT  freeContent
			 , A.FREE_DATE     freeDate
			 , (
			 	SELECT B.USER_NICKNAME 
			 	FROM   TB_USER B
			 	WHERE  B.USER_ID = A.USER_ID
			 	)             freeWriter 
			 , A.ATCH_FILE_ID atchFileId
		FROM   FREE_BOARD A			
		WHERE  1=1
		AND    A.FREE_TITLE LIKE '%' || #freeTitle# || '%'
		OR     B.USER_NICKNAME LIKE '%' || #freeWriter# || '%'
	</select>
</sqlMap>